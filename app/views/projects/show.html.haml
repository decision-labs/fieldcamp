- content_for :head do
  = stylesheet_link_tag 'google'
  = javascript_include_tag 'GeoJSON'
  :javascript
    function initialize() {
      var pathname = window.location.pathname;
      var myLatlng = new google.maps.LatLng(30.375, 69.345);
      var myOptions = {
        zoom: 6,
        center: myLatlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      }
      var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
      
      $.get(pathname+'.json', function(geojson) {
        province = new GeoJSON(geojson, null);
        province.setMap(map);
      });
      
      $.get(pathname+'/events.json', function(geojson) {
        for (var i=0;i<geojson.geometries.length;i++){
          event = new GeoJSON(geojson.geometries[i], null);
          event.setMap(map);
        }
      });
    }

    function loadScript() {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src = "http://maps.google.com/maps/api/js?sensor=false&callback=initialize";
      document.body.appendChild(script);
    }

    window.onload = loadScript;

#map_canvas

%p
  %b Title:
  = @project.title
%p
  %b Description:
  = @project.description
%p
  %b Admin:
  = @project.admin_id
%p
  %b Start date:
  = @project.start_date
%p
  %b End date:
  = @project.end_date

%h2 Recent Events
= render :partial => 'events/event', :collection => @project.events

= link_to 'Edit', edit_project_path(@project)
\|
= link_to 'Back', projects_path
\|
= link_to 'Events', project_events_path(@project)